<!DOCTYPE html>
<html th:lang="${#locale}">
<head th:replace="fragments/head" />
<body>
	<!-- Barra de NavegaciÃ³n superior -->
	<nav th:replace="fragments/nav" />
	<div class="container mt-2" th:if="not ${#lists.isEmpty(resultsList)}">
		<h1 class="display-4 text-center" th:text="#{result.list.title}">Resultados</h1>
		<div class="wb-cont mt-2 mb-2">
			<div th:each="result : ${resultsList}">
				<div class="resultHeader">
					<span class="pTitle" th:text="#{result.list.pTitle}">Programa: </span>
					<a th:href="${'/program/detail/' + result.program.id}">
						<span th:text="${result.program.name}"></span>
					</a>
					<a class="btn btn-primary ml-auto mr-2" th:href="${'/result/' + result.id}" th:text="#{detail}">Detail</a>
					<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteModal" th:data-url="${'/result/' + result.id + '/delete'}" th:text="#{delete}">Borrar</button>
				</div>
				<div class="container" th:if="${not #lists.isEmpty(result.queryExecutionProblems)}">
					<div class="text-center m-4 text-danger" th:text="#{result.detail.queryErrors}">Query errors</div>
				</div>
				<div class="table-responsive" th:if="${not #lists.isEmpty(result.problems)}">
					<table class="table table-hover">
						<thead>
							<tr>
								<th th:text="#{result.detail.msg}">Message</th>
								<th th:text="#{result.detail.description}">Description</th>
							</tr>
						</thead>
						<tbody>
							<th:block th:each="error,iter : ${result.problems}">
								<tr th:if="${ iter.index <= maxSize - 1 }">
									<td th:if="${error.msg}" th:text="${error.msg}">
										<span th:text="${error.msg}"></span>
									</td>
									<td th:unless="${error.msg}">
										<span th:text="#{result.detail.noMsg}"></span>
									</td>
									<td th:if="${error.query}">
										<a th:text="${error.query.description}" th:href="${'/query/detail/' + error.query.id}"></a>
									</td>
									<td th:unless="${error.query}" th:text="#{result.detail.userDeletedQuery}"></td>
								</tr>
							</th:block>
						</tbody>
					</table>
					<div th:if="${#lists.size(result.problems) > maxSize}" th:text="#{result.detail.full}" class="text-center m-2">No se han mostrado todo los resultados, entre en el detalle para mostrarlos todos</div>
				</div>
			</div>
		</div>
		<div th:replace="fragments/pagination"/>
	</div>
	
	<div class="container" th:if="${#lists.isEmpty(resultsList)}">
		<h2 class="text-center mt-5" th:text="#{result.list.empty}">No results to show</h2>
	</div>
	
	<div th:replace="fragments/deleteDialog"/>
	
	<footer th:replace="fragments/footer" />
</body>
</html>